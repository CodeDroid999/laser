# LASER - [**L**]c3 [**AS**]sembl[**ER**]

## Description

An assembler for the LC3 assembly language written entirely in C. I've been trying to move away from LC3Edit provided by my university, which is old and hurts my eyes, and an assembling programs was the last thing I used LC3Edit for.

### Motivation

The completion of this tool allows me to do everything LC3-related from VSCode, my editor of choice. Or it would, except that I've already finished the course and am just using this project to practice my C coding. Hopefully someone down the line will appreciate my efforts in creating a command line LC3 assembler. All in all, this is a wonderful learning experience and I look forward to next semester!

### Differences from LC3Edit

Laser implements the basic funcitonality of the assembler included in LC3Edit, with some changes, including a new feature. These differences are as follows:

1. Aside from the existing pseudoops `ORIG`, `END`, `STRINGZ`, `BLKW`, `FILL`, there is an additional `ALIAS` pseudoop. `ALIAS` allows you to declare an alias for a word before the `.ORIG x____` declaration, and is similar to a `#define` statement in C. For example, if you were to `.ALIAS foo bar`, then every occurence of `foo` in your code following the `.ORIG` would be replaced with `bar` at compile time. The intention is to allow you to 'name' your registers, making it easier to keep track of your operations.
2. By using the command `laser -a *.asm` you can assemble all assembly files in a directory. This is especially useful when dealing with programs utilizing data files or user-defined subroutines. For this reason, `laser`'s error reporting system will include the file name along with the line number that the error originates from.
3. Hex and binary numbers used in `.FILL`s will be sign extended to 4 hex characters and 16 binary bits and calculated accordingly, as opposed to zero-extending like LC3Edit. For the most part, functionality is unchanged, except for hex numbers leading with '8' or greater, and binary numbers leading with '1'. For example, LC3Edit assembles `.FILL xA` as `x000A`, while `laser` will assemble it as `xFFFA`. To get `laser` to fill `x000A`, add a leading 0 - `.FILL x0A`.
4. `laser` has error-checking features similar to LC3Edit, but separates the severity of these errors into three separate tiers:
   1. Warning: The program will assemble and a loadable object file will be produced, but unexpected errors may occur when running.
   2. Error: The program will not assemble and no loadable object file will be produced.
   3. Exception: The program has caused an exception to be thrown in the assembler and should be reported here as an issue.
5. `laser` will continue to attempt to assemble the entirety of a program even if errors are met during Pass 1, whereas LC3Edit will stop before Pass 2 if there are errors during Pass 1. This is because `laser` checks operand type (register, offset, immediate) during Pass 2 to allow for the `.ALIAS` pseudoop functionality, whereas LC3Edit checks for this type of error during Pass 1.

### Usage

Laser is a command line tool, and is relatively simple one at that. Here is how to use it after installation on your system:

```
Usage:
-v: 'laser -v' displays version number
-h: 'laser -h' displays this message again
-a: 'laser -a <file>' assembles the specified file
    'laser -a *.asm' assembles all assembly files in current directory
-c: 'laser -c <file>' removes all files generated by 'laser -a <file'
    'laser -c *.asm' removes all files generated by 'laser -a *.asm'
```
You can use the command `laser -a *.asm` or `laser -c *.asm` to assemble or clean all assembly files in a directory. This is particularly handy when dealing with your own service routines or data that needs to be assembled and loaded separately from the main program.

## Building from Source

If you would like to give `laser` a try, here are the instructions for building on Mac, Linux, or Windows Subsystem Linux. Mac users must have `xcode` installed, and Linux users must have `build-essential` installed. Open a terminal, and execute the following commands:

1. Clone this repository: `git clone https://github.com/PaperFanz/laser.git`
2. Go to the `src` directory: `cd laser/src`
3. Build the project using the included Makefile: `make`
4. `sudo make install` (if you want to use `laser` without selecting the directory and using ./laser)

This last step might not work for Mac users, but Linux users (including Windows Subsystem Linux) should have no issues. Alternatively, you may choose to manually copy the compiled binary to your `bin` directory of choice.

## Notice

The base features of this project are now complete, and the functions listed above in the Usage section are entirely useable. If there are any issues with the assembler (specifically if it hangs, throws an exception, or crashes) please create an issue and I will deal with it ASAP.

~~NOTE: This project is not yet complete. Here are the things that still need to be implemented:~~

1. ~~Generating the symbol table~~	Completed 12/21/2018
2. ~~Generating the binary file~~	Completed 1/3/2019
3. ~~Generating the hex file~~		Completed 1/3/2019
4. ~~Generating the list file~~		Completed 1/3/2019
5. ~~Error checking~~				Completed 1/4/2019
6. ~~Generating the object file~~	Completed 1/4/2019

~~I've got a lot of work to do.~~ Good thing winter break is forever.